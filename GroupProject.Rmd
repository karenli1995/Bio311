# Bio311

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(stringr)
library(dendextend)
library(RColorBrewer)
library(gProfileR)
library(org.Sc.sgd.db)
```

## Data Processing
```{r data, echo=FALSE, warning=FALSE}
huebert_expr <- read.csv("huebert-2012-expression.csv", 
                         stringsAsFactors = FALSE, 
                         fileEncoding = "latin1")

# transpose and convert matrix to data frame
huebert_expmt <- huebert_expr[,7:28] %>% sapply(as.numeric) %>% 
  t() %>% as.data.frame()

# use this for correlation matrix (no time column)
colnames(huebert_expmt) <- huebert_expr$ID

# split rownames to get time
huebert_times <- colnames(huebert_expr)[7:28] %>% strsplit("[.T]") %>% 
  sapply(function(x) as.numeric(x[4]))
# add the experiment condition and time columns
huebert_expmt2 <- huebert_expmt
huebert_expmt2$expt <- colnames(huebert_expr)[7:28]
huebert_expmt2$time <- huebert_times
# reorder
huebert_expmt2 <- huebert_expmt2[,c(11236:11237, 1:11235)]
```

```{r csv, echo=FALSE}
huebert_TF <- read.csv("huebert-2012-TFbinding-annotated.csv", fileEncoding = "latin1")
```

## Hierarchical Clustering
```{r hier_cluster, warning=FALSE}
huebert.cor <- huebert_expmt %>% cor(use = "pairwise.complete.obs")
huebert.cor[is.na(huebert.cor)] <- -1  # assume all NA's in correlation matrix is -1
huebert.clust <- hclust(as.dist(1 - huebert.cor), method = "complete")
huebert.dend <- as.dendrogram(huebert.clust)

color.dend <- color_branches(huebert.dend, h = 1.3, col = brewer.pal(8, "Dark2"))
plot(color.dend, leaflab = "none")
```